version: 0.2

phases:
  install:
    runtime-versions:
      java: corretto17
    commands:
      - echo "í˜„ì¬ ë¸Œëœì¹˜:$CODEBUILD_SOURCE_VERSION"
      - |
        if [[ "$CODEBUILD_SOURCE_VERSION" == "refs/heads/main" ]]; then
          echo "main ë¸Œëœì¹˜ì— ëŒ€í•œ ë¹Œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤."
        elif [[ "$CODEBUILD_SOURCE_VERSION" == "refs/heads/develop" ]]; then
          echo "develop ë¸Œëœì¹˜ì— ëŒ€í•œ ë¹Œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤."
        else
          echo "main,develop ë¸Œëœì¹˜ê°€ ì•„ë‹™ë‹ˆë‹¤."
          exit 1  
        fi
      - chmod +x ./gradlew
  pre_build:
    commands:
      - echo "ë„ì»¤ ë¡œê·¸ì¸ ì‹œë„..."
      - echo "$DOCKER_PASSWORD" | docker login -u $DOCKER_USER_NAME --password-stdin || { echo "ë¡œê·¸ì¸ ì‹¤íŒ¨"; exit 1; }


  build:
    commands:
      - ./gradlew clean
      - echo "ğŸ§ª í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤í–‰"
      - ./gradlew test
      - echo "ë¹Œë“œ ë° íŒ¨í‚¤ì§• ì‹¤í–‰"
      - ./gradlew build --no-daemon

artifacts:
  files:
    - build/libs/*.jar
	